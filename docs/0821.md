# 对 AWS 负责—轻松管理云

> 原文:[https://www . edu reka . co/blog/ansi ble-for-AWS-provision-ec2-instance](https://www.edureka.co/blog/ansible-for-aws-provision-ec2-instance)

公司已经投入了大量的时间和金钱来开发和安装软件，以改善他们的运营。云计算的引入为他们的业务提供了在互联网上访问软件的服务，这被证明是更加高效和安全的。集成一个像 Ansible 这样的 IT 自动化工具就像是中了大奖，ansi ble 可以像 AWS 一样轻松地配置和管理您的云基础设施。这就是我们将要在这篇 Ansible for AWS 博客中讨论的内容。

**议程:**

*   [企业为什么要迁移到云？【T2](#WhyCompaniesMigrateToTheCloud)
*   [易变特性](#AnsibleFeatures)
*   [为什么对 AWS 使用 ansi ble](#WhyUseAnsibleForAWS)
*   [演示:使用 Ansible](#Demo) 自动提供 EC2 实例

*如果你想掌握 DevOps，[这门](https://www.edureka.co/devops?qId=15528fae0b7b58fb1a3c599f1cbe9c02&index_name=prod_search_results_courses&objId=776&objPos=1)课程将是你的首选。*

## **为什么企业要迁移到云？**

如前所述，云计算让公司可以通过互联网像软件一样访问服务器。说清楚一点，云计算就像接入中央电网，而不是自己发电。云已经成为新的常态，最终节省了大量时间和金钱。让我们来看看公司迁移到云的几个优势。

### **1。灵活性:**

业务增长从来都不是一成不变的。基于云的服务适合不断增长和波动的业务需求。基于需求扩展和缩减部署的特性使其非常灵活。

### **2。灾难恢复:**

每个企业都应该投资灾难恢复。每家《财富》公司最终都会在灾难恢复上投入大量资金。初创公司和低预算公司缺乏资金和所需的技能，并且无法具备适当的功能性灾难恢复特性。云为客户提供灾难恢复解决方案，以制定稳健且经济高效的计划。

### **3。软件自动更新:**

众所周知，云是互联网提供的服务，因此所有的服务器都不在你的掌控之中，或者说不是你头疼的问题。供应商会对它们进行维护，包括在需要时进行更新，以及定期进行安全检查。这再次节省了大量的时间和金钱。

### **4。降低成本:**

从头开始建立一个数据中心可能会非常昂贵。运行和维护增加了费用。您需要合适的技术、合适的硬件、拥有合适知识和经验的合适员工，这在我看来是一项艰巨的任务。同样，不太乐观的是，有一百万种方式会出错。迁移到云给了你这个加分。

### **5。可扩展性:**

规划意外增长的传统方式是购买和保留额外的服务器、存储和许可证。在你真正使用它们之前，可能需要几年时间。云平台允许您在需要时扩展这些资源。这种动态扩展非常适合不可预测的增长。

### **6。数据安全:**

大多数时候，将数据保存在云上比存储在笔记本电脑或硬盘等物理设备上更好。这些物理设备很有可能被盗或损坏。云允许您远程删除数据或将其转移到另一台服务器，确保数据保持完整和安全。

### **7。增加协作:**

使用云平台，团队可以随时随地访问、编辑和共享文档。他们能够一起工作，因此提高了效率。这也提供了实时和透明的更新。

Ansible 有一些独特的功能，当这些功能与亚马逊网络服务合作时，会留下印记。让我们来看看这些不可思议的功能:

1.  与厨师和木偶不同，Ansible 基于无代理架构
2.  Ansible 通过 SSH 访问其主机，这使得服务器和主机之间的通信变得轻而易举
3.  不需要定制的安全基础设施
4.  配置行动手册和模块非常简单，因为它遵循 YAML 格式
5.  为客户提供各种模块
6.  允许完整的配置管理、编排和部署功能
7.  秘密金库保证秘密安全

从 [AWS 云迁移课程](https://www.edureka.co/migrating-to-aws)中了解更多关于迁移到 AWS 及其框架的信息。

## **为什么对 AWS 使用 Ansible？**

现在我们已经了解了使用 AWS 这样的云平台的好处和 Ansible 的独特功能，让我们来看看整合这两个传奇所创造的魔力。

### **1。云视集团服务**

云不仅仅是其他人的数据中心上的一组服务器，还远远不止这些。一旦在其上部署了服务，您就会意识到这一点。有许多服务可以让您快速部署和扩展应用程序。Ansible automation 帮助您像管理一组服务一样管理 AWS 环境，而不是像管理一组服务器一样使用它们。

### **2。支持 AWS** 的可变模块

Ansible 用于定义、部署和管理各种各样的服务。大多数复杂的 AWS 环境都可以使用行动手册非常轻松地进行调配。最好的功能是，您创建一个服务器-主机连接，然后只在一个系统上运行剧本，并为多个其他系统提供一个根据需要进行扩展和缩减的选项。

Ansible 拥有数百个支持 AWS 的模块，其中包括:

*   自动缩放组
*   云的形成
*   云迹
*   云观察
*   DynamoDB
*   弹性缓存
*   弹性云计算(EC2)
*   身份访问管理器(IAM)
*   λ
*   关系数据库服务
*   路线 53
*   安全组
*   简单存储服务(S3)
*   虚拟私有云(VPC)
*   还有更多

### **3。** 动态库存

在开发环境中，主机会随着不同的业务需求而不断启动和关闭。在这种情况下，使用静态库存可能是不够的。这种情况需要使用动态库存。这使您可以根据清单脚本提供的组来映射主机，这与普通清单不同，普通清单迫使您手动映射主机，这非常繁琐。

### **4。安全自动化**

假设你有一个 5 人团队，每个人下面都有两个不完全熟练的下属。您不会想让他们完全访问整个部署过程。这时，您就会意识到限制授权的必要性。

Ansible Tower 提供此功能来限制授权。所以基本上，你选择了谁能做什么，这样更容易调和。此外，Ansible Tower 对凭证和其他敏感数据进行加密，您只允许下属访问相关资源，而限制他们访问不相关的资源。

## **演示:使用 Ansible** 自动提供 EC2 实例

在本演示部分，我将通过展示如何自动化 EC2 实例的启动和供应来演示 Ansible 如何支持 AWS。让我们开始吧。

**第一步** :

在您的服务器节点上安装 Ansible，并在您的服务器和 AWS 上的客户端节点之间建立 SSH 连接。在本例中，我创建了两个 EC2 实例，一个安装了 Ansible 的服务器，另一个是客户端。

**第二步:**

现在确保你已经安装了所有的需求。根据文档，这些要求如下:

*   Python > = 2.6
*   博托

使用以下命令安装 python:

T2`$ sudo apt install python`

使用以下命令安装 boto:

T2`$ sudo apt install python-pip $ pip install boto`

Boto 是一个使用亚马逊网络服务的 python 接口。您必须使用以下命令导入它:

T2`$ python $ import boto $ exit()`

![boto - Ansible For AWS - Edureka](../Images/96f6cfe76b2ca1295ce9684ee5dac480.png)T2】

**第三步:**

你必须配置你的 AWS。同样使用以下命令:

T2`$ aws configure`

并添加您的 AWS 访问密钥 id、密钥和默认区域(可选)。

**第四步:**

编写一个行动手册来启动和配置 EC2 实例。

`$ sudo vi /etc/ansible/launch.yml`

```
---

- name: Create an ec2 instance
  hosts: web
  gather_facts: false

  vars:
      region: us-east-1
      instance_type: t2.micro
      ami: ami-05ea7729e394412c8
      keypair: priyajdm

  tasks:

    - name: Create an ec2 instance
      ec2:
         aws_access_key: '********************'
         aws_secret_key: '****************************************'
         key_name: "{{ keypair }}"
         group: launch-wizard-26
         instance_type: "{{ instance_type }}"
         image: "{{ ami }}"
         wait: true
         region: "{{ region }}"
         count: 1
         vpc_subnet_id: subnet-02f498e16fd56c277
         assign_public_ip: yes
    register: ec2
```

在实际执行代码之前，了解代码的用途是一个好习惯。为了更好地理解，让我来解释一下这个剧本。

**名称:**随便什么都可以。一个好的做法是保留一个给出它所执行任务的基本描述的名称。

**主机:**提到需要执行剧本的主机列表的名称。对我来说是*网络*。

**gather_facts:** 该参数告诉 Ansible 收集所有相关的事实、变量和其他数据，以供将来参考。在我们的例子中，我们将它设置为 false，因为我们不需要收集事实(IP addr。主机名等)。

**变量:**本节定义并初始化我们将在本行动手册中使用的所有变量。我们这里有四个变量:

*   **区域**定义 EC2 实例需要出现的区域
*   **instance_type** 定义了我们要调用的实例的类型。在我们的例子中，我们使用 t2.micro
*   **ami** 定义了我们要调出的实例的 AMI

![ami - Ansible fFor AWS - Edureka](../Images/3d79433a675a484e77c088922aa2f5b0.png)T2】

*   **keypair** 定义了我们将要用来调出实例的 keypair

**ec2:** 这是 Ansible 提供的一个模块，用于启动或终止一个 ec2 实例。

这个模块有一些参数，我们将使用这些参数来指定我们试图启动的 EC2 实例的其他功能。

*   我们首先使用参数 **aws_access_key** 和**AWS _ secret _ key**提到 AWS 访问密钥 id 和秘密密钥。
*   **key_name:** 传递定义这里使用的密钥对的变量
*   **组:** 提及安全组的名称。这定义了我们试图提出的 EC2 实例的安全规则
*   **instance_type:** 传递定义我们在这里使用的实例类型的变量
*   **图像:**传递定义我们试图启动的图像的 AMI 的变量
*   **等等:** 这个有一个非真即假的布尔值。如果为真，则在返回之前等待实例达到所需状态
*   **region:** 传递定义需要创建 EC2 实例的区域的变量。
*   **count:** 该参数指定需要创建的实例数量。在这种情况下，我只提到了一个，但这取决于您的需求。
*   **vpc_subnet_id:** 传递您希望在其中创建实例的子网 id
*   **assign _ public _ IP:**该参数有一个布尔值。如果是真的，就像我们的例子一样，那么在 VPC 内部调配时，将为实例分配一个公共 IP。

**第五步:**

现在你已经理解了行动手册中的每一行，让我们开始执行吧。使用以下命令:

T2`$ ansible-playbook /etc/ansible/launch.yml`

![Ansible playbook - Ansible For AWS - Edureka](../Images/d464597fe5fd809e8da251702f25d985.png)T3】

执行完行动手册后，您会看到一个实例正在创建。

![ec2 - Ansible For AWS - Edureka](../Images/94f54d844d46a1520808e8560cc3afff.png) 

还有 TADA！您已经成功地自动化了 EC2 实例的供应。同样，您也可以编写剧本来停止 EC2 实例。

这就把我们带到了 Ansible For AWS 博客的结尾。如果你觉得这篇文章有帮助，去看看由 Edureka 提供的 [DevOps 课程](https://www.edureka.co/devops?qId=15528fae0b7b58fb1a3c599f1cbe9c02&index_name=prod_search_results_courses&objId=776&objPos=1)。它涵盖了让 It 行业变得高效的所有工具。