# K-means 聚类算法:了解其工作原理

> 原文：<https://www.edureka.co/blog/k-means-clustering-algorithm/>

大多数零售企业主发现很难认识到顾客的需求。网飞、沃尔玛、塔吉特等数据驱动型公司。之所以做得这么好，是因为他们有一支由 ***[认证数据分析师](https://www.edureka.co/r-for-analytics)*** 组成的队伍，他们通过使用正确的工具来创建个性化的营销策略，从而发展自己的业务。我们理解并非所有的顾客都是相似的，有着相同的品味。因此，这导致了向正确的客户营销正确的产品的挑战。可能吸引特定客户群的优惠或产品可能对其他客户群没有太大帮助。因此，您可以应用 k-means 聚类算法，根据各种指标(如他们在社交媒体上的活动、喜欢和不喜欢以及他们的购买历史)将您的所有客户细分为具有相似特质和偏好的群体。根据这些确定的客户群，您可以制定个性化的营销策略，为您的组织带来更多业务。

我希望你喜欢阅读我之前的博客—[什么是数据科学](https://www.edureka.co/blog/what-is-data-science/) ，它详细介绍了机器学习和数据科学的生命周期。 在深入研究 k-means 聚类之前，我将介绍以下主题，让您对聚类有一个基本的了解。

*   机器学习简介
*   用实例聚类的需要
*   什么是聚类？
*   聚类的类型
*   k 均值聚类
*   实践:使用 r 在电影数据集上实现 k-means 聚类。基于电影的商业和观众中的受欢迎程度形成电影的聚类。

机器学习是最新、最令人兴奋的技术之一。你可能在不知不觉中一天用了几十次。机器学习是一种人工智能，它为计算机提供了无需显式编程即可学习的能力。它在监督和非监督学习模型上工作。 与监督学习模型不同，机器学习的非监督模型没有预定义的组，您可以在这些组下分发您的数据。您可以通过聚类找到这些分组。我会通过下面的例子进一步解释。

![Unlabeled data - k-means Clustering - Edureka](img/4bc345779bbe5bcac95876e5f2bd3b1c.png)

如图所示，数据点显示为蓝点。这些数据点没有可以用来区分它们的标签。你对这些数据一无所知。所以现在的问题是，你能在这些数据中找出任何结构吗？这个问题可以用聚类技术来解决。聚类会将具有相似数据点的不同标签下的整个数据集(这里称为聚类)划分为一个聚类，如下图所示。它被用作探索性描述性分析的一种非常强大的技术。

![Clustering - Edureka](img/a104f4b0199be1cf122ea1f8f1bb5328.png)这里，聚类技术已经将整个数据 p  点划分成两个聚类。一个聚类内的数据点彼此相似，但 与其他聚类不同。例如，你有病人症状的数据。现在，你可以根据这些症状找出特定疾病的名称。

让我们以谷歌新闻为例来进一步理解聚类。

谷歌新闻所做的是，每天都有成百上千的新闻出现在网络上，它将它们组合成连贯的新闻故事。让我们看看如何？

一旦你去了 news.google.com，你会看到无数的新闻故事，如下图所示。

![google news cluster - Edureka](img/eb94f96216916bc230de2cbfd3b69564.png)

它们被归入不同的新闻故事。在这里，如果你看到红色突出显示的区域，你会知道与特朗普和莫迪有关的各种新闻网址被分组在一个部分下，其余部分在其他部分。点击群中不同的网址，你会看到同一个主题的不同故事。因此，google news 会自动将同一主题的新故事聚集到预定义的集群中。

![genes cluster - Edureka](img/db0ffce3b9a55400336edeaed8fbc196.png) 聚类的另一个非常有趣的应用是在*基因组学*中。基因组学是对 DNA 的研究。正如你在图中看到的，不同的颜色如红色、绿色和灰色描述了一个人拥有或不拥有特定基因的程度。所以，你可以对一群人的 DNA 数据运行聚类算法来创建不同的聚类。这可以让你对特定基因的健康有非常有价值的了解。 

例如，达菲阴性基因型的人往往对疟疾有更高的抵抗力，一般在非洲地区发现。所以，你可以画出基因型和自然栖息地之间的关系，找出它们对特定疾病的反应。

因此，基本上聚类将具有相似性的数据集划分成不同的组，这些组可以作为进一步分析的基础。结果是，一个组中的对象彼此相似，但与另一个组中的对象不同。

现在，一旦你理解了什么是集群，让我们看看实现这些集群的不同方法。

**独占聚类** : ![Exclusive clustering - Edureka](img/e15e3eca6e933f41ebd5ea3aef7f17ba.png) 在独占聚类中，一个项目只属于一个聚类，而不是几个。在图像中，您可以看到属于聚类 0 的数据不属于聚类 1 或聚类 2。 k

![Overlapping clustering - Edureka](img/6534619e0b93adb2012abb4f8bda112f.png)  **重叠聚类** :   在这里，一个项目可以属于多个聚类，每个聚类之间的关联程度不同。模糊 C-均值算法是基于重叠聚类的。

![hierarchical clustering - Edureka](img/1d7ee2a2badc793d215e80bb4d51d223.png)

**层次聚类** : 在层次聚类中，聚类不是在单一步骤中形成的，而是遵循一系列划分来得出最终的聚类。它看起来像一棵树，如图所示。

在实现任何算法时，计算速度和效率成为最终结果的一个非常重要的参数。因此，我解释了 k-means 聚类，因为它 由于其更快的计算速度和易用性，在处理大型数据集时非常有效。

## **k-均值聚类**

k-means 聚类是最简单的算法之一，它使用无监督学习的方法来解决已知的聚类问题。k 均值聚类需要以下两个输入。

1.  k =集群的数量
2.  训练集(m) = {x1，x2，x3，……..，xm}

假设您有一个未标记的数据集，如下图所示，您想将这些数据分组到聚类中。

![unlabeled data - Edureka](img/ba26a439469365f0ffbc6587071280de.png)

现在，重要的问题是你应该如何选择最佳的聚类数？有两种可能的方法来选择簇的数量。

**(i) 【肘法:** 这里，你画一条 WSS(平方和以内)和聚类数之间的曲线。它被称为肘方法，因为曲线看起来像人的手臂，肘点为我们提供了最佳的聚类数。正如你所看到的，在肘点之后，WSS 的值有一个非常缓慢的变化，所以你应该把肘点的值作为最终的聚类数。

![Elbow method - Edureka](img/46497b765965c0236a6771a067a1761f.png)

**(ii)** **基于目的:** 可以运行 k-means 聚类算法，根据各种目的得到不同的聚类。您可以根据不同的指标对数据进行划分，并查看它在特定情况下的表现。我们举一个营销不同尺码 t 恤的例子。根据您想要达到的目的，您可以将数据集划分为不同数量的集群。 在下面的例子中，我采取了两种不同的标准，价格和舒适度。

让我们看看这两种可能性，如下图所示。

![T shirt clusters - Edureka](img/e47ddf5ea864b0918892b8a84e2d2a12.png)

1.  1。K=3:如果您想只提供 3 种尺寸(S、M、L)以便价格更便宜，您将把数据集分成 3 个聚类。
2.  K=5:现在，如果您想为您的客户提供更多尺寸(XS、S、M、L、XL)的舒适性和多样性，那么您将把数据集分成 5 个集群。

现在，一旦我们有了 k 的值，让我们来理解它的执行。![Initialisation image](img/4b8db71be49972672b60e69a3153fb13.png)

*   **初始化:**首先，需要随机初始化两个点，称为聚类质心。这里，您需要确保如图所示由橙色和蓝色十字表示的聚类质心小于由深蓝色点表示的训练数据点。k——表示聚类算法是一种迭代算法，它迭代地遵循接下来的两步。完成初始化后，让我们进入下一步。

*   **C![cluster assignment - Edureka](img/dc5d4ff0885fae03c74f9e8cdd5a87ad.png)光泽赋值:**在这一步中，它将遍历所有的深蓝色数据点，计算这些数据点与上一步初始化的聚类质心之间的距离。现在，根据与橙色簇形心或蓝色簇形心的最小距离，它会将自己分组到特定的组中。因此，数据点分为两组，一组用橙色表示，另一组用蓝色表示，如图所示。由于这些集群形式不是优化的集群，所以让我们继续，看看如何得到最终的集群。

![Move centroid - Edureka](img/c487fc72b2b4ba73fa6b690e27622b5d.png)

*   **移动质心:** 现在，你将取上述两个簇质心，迭代重新定位，进行优化。您将获得所有蓝点，计算它们的平均值，并将当前的聚类质心移动到这个新位置。类似地，将橙色聚类质心移动到橙色数据点的平均值。因此，新的簇质心将如图所示。接下来，让我们看看如何优化集群，这将为我们提供更好的洞察力。![Centroid convergence - Edureka](img/b90cf202634d58c21e80b0ac9d4906ec.png)
*   **优化:** 你需要反复重复以上两步，直到聚类质心停止改变位置，变成静态。一旦聚类变成静态的，那么 k-means 聚类算法就被认为是收敛的。

*   **收敛:** 最后，k-means 聚类算法收敛，将数据点分成清晰可见的橙色和蓝色两个聚类。根据聚类初始化的方式，k-means 可能最终收敛于不同的解。

正如你在下图中看到的，这三个集群清晰可见，但是你可能最终会得到不同的集群，这取决于你对集群质心的选择。

![Cluster partition - Edureka](img/369817b73a940bd3cd5a482387930c5e.png)

下面显示的是基于聚类质心的不同选择的聚类划分的一些其他可能性。根据您的需求和您试图实现的目标，您最终可能会拥有这些分组中的任何一个。【T2

![Cluster partition variety - Edureka](img/cbb88da6d9c25f22ef778362a42f9d21.png)

既然您已经理解了集群的概念，那么让我们来实际操作一下 R.

**k-means 聚类案例研究:电影聚类**

比方说，你有一个电影数据集，有 28 个不同的属性，从导演 facebook 喜欢、电影喜欢、演员喜欢、预算到总收入，你想找出观众中最受欢迎的电影。您可以通过 k-means 聚类来实现这一点，并将整个数据划分到不同的聚类中，并根据流行度做进一步的分析。

为此，我取了 28 个属性 5000 个值的电影数据集。

**第一步**。首先，我已经在 RStudio 中加载了数据集。

电影 _ 元数据<-read _ CSV(" ~/电影 _ 元数据. csv")

查看(电影 _ 元数据)

![Movie metadata - Edureka](img/01626bf1b3a1023c6b4bb71e05f042f0.png)

**第二步**。如您所见，该数据中有许多 NA 值，因此我将清理数据集并从中删除所有空值。

电影<-data . matrix(movie _ metadata)

电影< - na.omit(电影)

![Clean movie data - Edureka](img/761deacc758de5f458116063c9526131.png)

**第三步**。在本例中，我从数据集中选取了前 500 个值进行分析。

样本< -电影【样本(nrow(movie)，500)，】

**第四步**。 进一步，用下面的 R 代码，可以从数据集中取两个属性 budget 和 gross 来做聚类。

smple_short < - smple[c(9，23)]

smple _ matrix<-data . matrix(smple _ short)

视图(smple_matrix)

我们的数据集将如下所示。

![gross budget - Edureka](img/d87df4da6347a1832de04bc5ba7838ad.png)

**第五步。**现在，让我们来确定集群的数量。

WSS<-(nrow(smple _ matrix)-1)* sum(apply(smple _ matrix，2，var))

for(I in 2:15)WSS[I]<-sum(k means(smple _ matrix，centers=i)$withinss)

plot(1:15，wss，type="b "，xlab= "聚类数"，ylab= "平方和内")

它给出了如下的肘图。

![wss vs number of clusters - Edureka](img/23b5ae333fd0cfea72ca7565e6a54c3b.png)

如你所见，随着聚类数从 1 增加到 3，WSS 值(在平方和内)突然下降。因此，在 k=3 处的弯曲给出了 WSS 值的稳定性。我们需要在 k 和 WSS 之间取得平衡。因此，在这种情况下，它在 k=3 时出现。

**第六步**。 现在，有了这些干净的数据，我将在 R 中应用内置的 kmeans 函数来形成集群。

cl < - kmeans(smple_matrix，3，nstart=25)

您可以使用以下命令绘制图形和聚类质心。

plot(smple_matrix，col =(cl＄cluster+1)，main="k-means 结果与 2 个聚类"，pch=1，cex=1，las=1)

点数(cl$centers，col = "black "，pch = 17，cex = 2)

![k-means cluster - Edureka](img/081ca6a11a95e02341ed4103ef239bea.png)

**第七步**。现在，我将使用命令 **cl 来分析我的集群队形有多好。** 它给出如下输出。

聚类内按聚类平方和:

【1】3.113949 e+17 2.044851 e+17 2.966394 e+17

(between _ SS/total _ SS = 72.4%)

这里，total_SS 是每个数据点到全局样本均值的平方距离之和，而 between_SS 是聚类质心到全局均值的平方距离之和。 在这里，72.4 %是数据集中总方差的度量。k-means 的目标是最大化组间离差(between_SS)。因此，百分比值越高，模型越好。

**第八步**。 为了更深入地了解集群，我们可以使用cl＄centers组件来检查集群质心的坐标，如下所示为毛额和预算(以百万为单位)。

总预算

1 91791300 62202550

2 223901969 118289474

3 18428131 19360546

根据聚类中心，我们可以推断聚类 1 和聚类 2 的毛收入比预算多。因此，我们可以推断，集群 1 和集群 2 获利，而集群 3 亏损。

**第九步**。此外，我们还可以检查聚类分配如何与个人特征相关，如 director_facebook_likes(第 5 列)和 movie_facebook_likes(第 28 列)。我取了以下 20 个样本值。

![Movie facebook likes - Edureka](img/f6fbb2d4bbb5a32adc38b6f5f56e8c5e.png)

使用聚合函数，我们可以查看数据的其他参数并获得洞察力。正如你在下面看到的，第三组是 facebook 最不喜欢的电影，也是导演最不喜欢的电影。这是意料之中的，因为集群 3 已经处于亏损状态。此外，第二类在获得最大点赞和最大总点击率方面做得相当不错。

![Aggregate movie likes - Edureka](img/843b21fd31908cbe805162fefcc9b9f4.png)

![Aggregate director likes - Edureka](img/045b02f9c1e6a80e8ae00682819ef89b.png)

像网飞这样的组织正在利用聚类来锁定在观众中最受欢迎的电影群。他们正在出售这些电影，从中赚取巨额利润。

网飞产品分析总监戴夫·黑斯廷斯(Dave Hastings)说:“我们生活在客户之中，与客户息息相关。 目前，网飞拥有 9380 万全球流媒体客户。他们在网上密切关注你的一举一动，比如你喜欢什么电影，你喜欢哪个导演，然后根据受欢迎程度对电影进行聚类。现在，他们从最受欢迎的集群中推荐电影，并提升他们的业务。

我强烈建议你看一下这个 k-means 聚类算法视频教程，它解释了我们在博客中讨论的所有内容。继续，欣赏视频，告诉我你的想法。

## **K-Means 聚类算法——聚类分析|爱德华卡**



[//www.youtube.com/embed/4R8nWDh-wA0?rel=0&showinfo=0](//www.youtube.com/embed/4R8nWDh-wA0?rel=0&showinfo=0) This video will help you understand the working of the K-Means Algorithm with hands-on.

我希望你喜欢阅读我的博客并理解 k-means 聚类。用 R 做项目后，可以给简历大大加分。这最终会导致招聘人员蜂拥到你身边。如果您有兴趣了解更多信息，请点击此处查看我们的[数据科学认证培训](https://www.edureka.co/data-science)，该培训包含讲师指导的现场培训和真实项目体验。

![edureka-logo](img/17b384eac14ae8abcfa768bc10276bbe.png)